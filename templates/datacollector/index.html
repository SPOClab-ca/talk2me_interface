{% extends "datacollector/base.html" %}

{% block title %}{{ website_name }}{% endblock%}

{% block auth_user %}
    {% if is_authenticated %}
        Logged in as {{ user.username }} (<a href="/datacollector/logout">logout</a>)
    {% else %}
        <a href="{{ request.path }}login">Login</a> | <a href="{{ request.path }}register">New User</a>
    {% endif %}
{% endblock %}

{% block content %}



{% if is_authenticated %}
    
    {% if not consent_submitted %}

        <form action="" method="POST">
        {% csrf_token %}
        <input type='hidden' id='form_type' name='form_type' value='consent' />

        <h1>Informed Consent</h1>
        <hr />

        <h3>Research Project</h3>
        <p>The <a href="http://www.cs.toronto.edu/compling/index.html">Computational Linguistics</a> group at the <a href="http://www.cs.toronto.edu/">Department of Computer Science</a> in the <a href="http://www.utoronto.ca/">University of Toronto</a> is conducting a study to analyze the differences in longitudinal progression of linguistic markers between healthy older adults and ones with dementia. We are interested in assessing the validity and usability of an automated web-based system ({{ website_name }}) for linguistic data acquisition, as means for longitudinal monitoring of changes in language ability. To familiarize yourself with the purpose, procedures, and risks of the project, please <a target="_blank" href="{{ request.path }}about">click here</a>. When you have carefully read the linked document, you can proceed with the consent form below.</p>

        <h3>Contact Information</h3>
        
        <div class="row" style='margin-bottom: 10px;'>
            <div class="col-md-12">
                <address>
                <strong>Maria Yancheva, MSc Candidate</strong><br />
                Principal Investigator<br />
                D. L. Pratt Bldg<br />
                6 King's College Road, Room PT276 D3<br />
                Toronto, Ontario M5S 3G8<br />
                416-830-2434<br />
                <a href="mailto:yancheva@cs.toronto.edu">yancheva@cs.toronto.edu</a><br />
                </address>
            </div>
        </div>
        
        <div class="row" style='margin-bottom: 10px;'>
            <div class="col-md-12">
                <address>
                <strong>Frank Rudzicz, PhD</strong><br />
                Faculty Supervisor<br />
                Toronto Rehabilitation Institute - UHN<br />
                550 University Avenue, Room 12-175<br />
                Toronto, Ontario M5G 2A2<br />
                416-597-3422 x7971<br />
                <a href="mailto:frank@cs.toronto.edu">frank@cs.toronto.edu</a><br />
                </address>
            </div>
        </div>

        <p><u>If you have any questions regarding your rights as a research participant, you can contact the Office of Research Ethics (<a href="mailto:ethics.review@utoronto.ca">ethics.review@utoronto.ca</a> or +1 416-946-3273).</u></p>
        
        <p>The purpose, procedures and risks of the project have been explained to me and I fully understand them. I have been given the chance to ask questions and these were answered to my satisfaction. I understand that I am free to ask questions about the study at any time.</p>

        <p>I understand that I will be asked to complete a demographic questionnaire prior to participation in the study, participate in one or more sessions consisting of questions testing cognitive ability, and complete an optional post-study usability questionnaire. The data collected as part of this study will be used for research purposes only, and will be retained for an indefinite length of time to facilitate future research.</p>

        <p>I understand that my participation is voluntary and that I may withdraw from the study at any time, either by contacting the investigators directly or through the website. I understand that all personal information and data recorded up to that point will be destroyed immediately. I also understand that in no way my acceptance to participate or my withdrawal from participation will affect my interests in any way.</p>

        <div class="consent-main">
            <div class="consent-container">
                <div class="radio">
                    <label><input name='radio_consent' type='radio' value="participant">&nbsp;<strong>I am the participant, I have read the entire consent form, and I consent to participate in this study</strong></label>
                </div>
                <div class="radio">
                    <label><input name='radio_consent' type='radio' value="alternate">&nbsp;<strong>I am an alternate decision maker who has read the entire consent form, and I provide consent on behalf of the participant. The participant has read the entire consent form and assents to participate in this study</strong></label>
                </div>
            </div>
        </div>
        
        <br />
        <p>The following selections are optional, but would greatly benefit research outcomes:</p>
        <div class="checkbox">
            <label><input id='cb_preference_public_release' name='cb_preference_public_release' type='checkbox'>&nbsp;<strong>In the event that the data recorded in this study is made public for research purposes, I agree to include my data, provided that all data is presented anonymously (i.e., my username and email address are not disclosed).</strong> I understand that the nature of the language data I provide during the study (e.g., audio recordings) may itself be used to discover my identity.</label>
        </div>
        
        <div class="checkbox">
            <label><input id='cb_preference_email_reminders' name='cb_preference_email_reminders' type='checkbox' onClick="javascript: showCbDetails(this);">&nbsp;<strong>I wish to receive scheduled e-mail reminders (e.g., weekly or monthly) to complete new sessions on the website (each session takes approximately 15 minutes).</strong> I understand that I can unsubscribe from such communications at any time, either through the "Unsubscribe" link located in each e-mail, or through the website. Requested communications will be sent to this e-mail address, which will not be shared with any third parties or used for commercial purposes.</label>
        </div>
        <div id="detail_preference_email_reminders" class="invisible" style="margin-left: 20px;">
            <div style="margin-bottom: 15px;">E-mail address: 
            <input id='preference_email_reminders' name='preference_email_reminders' style='width: 200px;' type='text' value=''></div>
            Frequency: 
            <div class="radio" style="display: inline; margin-left: 10px; margin-bottom: 15px;">
                <label class="radio-inline"><input type="radio" name="radio_email_reminders_freq" value="7"> Weekly</label>
                <label class="radio-inline"><input type="radio" name="radio_email_reminders_freq" value="30" checked="checked"> Monthly</label>
            </div>
        </div>
        
        <div class="checkbox">
            <label><input id='cb_preference_email_updates' name='cb_preference_email_updates' type='checkbox' onClick="javascript: showCbDetails(this);">&nbsp;<strong>I wish to receive electronic communication regarding study outcomes, updates and research publications</strong> based on the data collected as part of this study. I understand that I can unsubscribe from such communications at any time, either through the "Unsubscribe" link located in each e-mail, or through the website. Requested communications will be sent to this e-mail address, which will not be shared with any third parties or used for commercial purposes.</label>
        </div>
        <div id="detail_preference_email_updates" class="invisible" style="margin-left: 20px;">
            E-mail address: <input id='preference_email_updates' name='preference_email_updates' style='width: 200px;' type='text' value=''>
        </div>
        <br />

        <button type="submit" class="btn btn-primary">Submit</button>
        </form>

    {% else %}
    {% if not demographic_submitted %}
    
        <h1>Demographic Data</h1>
        <hr />
        
        <p>Please provide the following anonymous demographic data, which will aid the analysis of your results.</p>
        
        <form action="" method="POST">
        {% csrf_token %}
        <input type='hidden' id='form_type' name='form_type' value='demographic' />
        <ol>
            <li><span>Gender</span><br />
                {% for opt in gender_options %}
                <input type="radio" name="gender" value="{{ opt.gender_id }}"> {{ opt.name }}<br />            
                {% endfor %}
            </li>
            
            <!--
            <li><span>Date of birth</span><br />
                <input type='text' class='datefield' value="" />
            </li>
            -->
            
            <li>Spoken languages<br />
                {% for opt in language_options %}
                <input type="checkbox" name="language" value="{{ opt.language_id }}"> {{ opt.name }}<br />            
                {% endfor %}
            </li>
            
            <!--
            <li>Country
            
            </li>
            
            <li>Education level (highest completed, or currently being completed)
            
            </li>
            
            <li>Have you ever been diagnosed with dementia? If yes, please select all applicable types:
            
            </li>
            
            <li>Ethnicity
            
            </li>
            -->
        </ol>
        
        <input class='button' type='submit' value='Submit' />
        </form>

    {% else %}
    
        <h1>Index</h1>
        <p>
        
        <hr/>
        <div class="support_html5 bs-callout bs-callout-danger invisible">
            {{ website_name }} requires a modern browser which supports HTML5. You are using a browser which does not support this technology. <strong>To use {{ website_name }}, please download the latest version of <a href="https://www.google.com/chrome/browser/desktop/index.html" target="_blank">Chrome</a> or <a href="https://www.mozilla.org/en-US/firefox/new/" target="_blank">Firefox</a></strong>. You cannot continue existing sessions, or create new ones, until you update your browser.<br />
            <a href="https://www.google.com/chrome/browser/desktop/index.html" target="_blank"><img src="{{ STATIC_URL }}img/chrome.png" style="height: 40px; margin: 5px; border-bottom: 1px dotted #333" /></a>
            <a href="https://www.mozilla.org/en-US/firefox/new/" target="_blank"><img src="{{ STATIC_URL }}img/firefox.png" style="height: 40px; margin: 5px; border-bottom: 1px dotted #333" /></a>
        </div>
        
        <div class="unsupported_html5">
            <h4><a href="{{ request.path }}startsession">Start a new session</a></h4>
        </div>
        
            {% if active_sessions %}
            <div class="unsupported_html5">
                <hr/>        
                <h4>Active sessions:</h4>
                    <table class='table table-striped' style='width: 100%;'>
                    <thead><tr><th style='width: 20%;'>Session ID</th><th style='width: 30%;'>Start Date</th><th style='width: 30%;'></th></tr></thead>
                    <tbody>
                    {% for session in active_sessions %}
                        <tr><td>{{ session.session_id }}</td><td>{{ session.start_date }}</td><td><a href="{{ request.path }}session/{{ session.session_id }}">Continue session</a></td></tr>
                    {% endfor %}
                    </tbody>
                    </table>
            </div>
            {% endif %}
            

            {% if completed_sessions %}
            <hr/>        
            <h4>Completed sessions:</h4>
                <table class='table table-striped' style='width: 100%;'>
                <thead><tr><th style='width: 20%;'>Session ID</th><th style='width: 30%;'>Start Date</th><th style='width: 30%;'>End Date</th></tr></thead>
                <tbody>
                {% for session in completed_sessions %}
                    <tr><td>{{ session.session_id }}</td><td>{{ session.start_date }}</td><td>{{ session.end_date }} (<a href="{{ request.path }}session/{{ session.session_id }}">View</a>)</td></tr>
                {% endfor %}
                </tbody>
                </table>
            {% endif %}
        </ul>
        </p>
    {% endif %} <!-- ends demographic if -->
    {% endif %} <!-- ends consent if -->
    
{% else %}

    <h1>{{ website_name }}</h1>
    <a href="{{ request.path }}login">Login</a> | <a href="{{ request.path }}register">New User</a>

    <div class="support_html5 bs-callout bs-callout-danger invisible">
        {{ website_name }} requires a modern browser which supports HTML5. You are using a browser which does not support this technology. <strong>To use {{ website_name }}, please download the latest version of <a href="https://www.google.com/chrome/browser/desktop/index.html" target="_blank">Chrome</a> or <a href="https://www.mozilla.org/en-US/firefox/new/" target="_blank">Firefox</a></strong>.<br />
        <a href="https://www.google.com/chrome/browser/desktop/index.html" target="_blank"><img src="{{ STATIC_URL }}img/chrome.png" style="height: 40px; margin: 5px; border-bottom: 1px dotted #333" /></a>
        <a href="https://www.mozilla.org/en-US/firefox/new/" target="_blank"><img src="{{ STATIC_URL }}img/firefox.png" style="height: 40px; margin: 5px; border-bottom: 1px dotted #333" /></a>
    </div>
    
    <!--
    <div class="jumbotron">
      <div class="container">
        <h1>{{ website_name }}</h1>
        <p>The <a href="http://www.cs.toronto.edu/compling/index.html">Computational Linguistics</a> group at the <a href="http://www.cs.toronto.edu/">Department of Computer Science</a> in the <a href="http://www.utoronto.ca/">University of Toronto</a> is conducting a study analyzing the differences in longitudinal progression of linguistic markers between healthy older adults and those with dementia. We are interested in assessing the validity and usability of an automated web-based system, <em>{{ website_name }}</em>, for linguistic data acquisition, as a means of monitoring changes in language ability.</p>
        <p><a class="btn btn-primary btn-lg" role="button" onClick="javascript: location.href='{{ request.path }}help';">Learn more &raquo;</a></p>
      </div>
    </div>
    
    <div class="row">
        <div class="col-md-4">
            <h2>Step 1: Sign up</h2>
            <p>Register for a new user account if this is your first visit, or login if you already have one.</p>
            <p><button class='btn btn-default' onClick="javascript: location.href='{{ request.path }}login';">Login</button> <button class='btn btn-default' onClick="javascript: location.href='{{ request.path }}register';">New User</button></p>
        </div>
        
        <div class="col-md-4">
            <h2>Step 2: Language data</h2>
            <p>Register for a new user account if this is your first visit, or login if you already have one.</p>
            
        </div>
        
        <div class="col-md-4">
            <h2>Step 3: Spread the word</h2>
            <p>Register for a new user account if this is your first visit, or login if you already have one.</p>
            
        </div>
    </div>
    -->
{% endif %}

{% endblock %}
